\documentclass{article}

\usepackage[TU]{fontenc}
\usepackage[english, russian]{babel}
\usepackage{fevcard}
\usepackage{xifthen}
\usepackage{datatool}
\usepackage[a4paper,margin=0.4in]{geometry}
\setlength\parindent{0pt}
\usepackage{fontspec}
\renewcommand{\familydefault}{\sfdefault}
\usepackage{libertine}

\begin{document}
\exhyphenpenalty 10000
\hyphenpenalty 10000
\DTLsetseparator{,}
\DTLloaddb{cards}{cards.csv}
\newtcard{card}{%
	\newcommand\cardwidth{2.5in}%
	\newcommand\cardheight{3.5in}%
}{%
	\useasboundingbox[clip] (-0.5*\cardwidth,-0.5*\cardheight) rectangle (0.5*\cardwidth,0.5*\cardheight);%
 \drawborder{0.1in}{0.15in}%
}%
\newcommand{\Repeat}[2]{% \repeat already defined
    \foreach \n in {1,...,#1}{#2}
}
\expandtcard{fev}{card}{%
	\newtcardvar{cardtext}{Трогать женскую грудь}%
	\newtcardvar{type}{ЛАЙТ}%
    \newtcardvar{randomdir}{R}
    \newtcardvar{randomcount}{3}
    }
    {%
    
	\linenode[draw,line width=0.025in,rounded corners=0.1in]{-1.1,1.35}{1.1,1.6}{\thetype}

    \pagenode[draw]{-1.1,0.05in}{1.1in,-1.1in}{\raggedright \ifthenelse{\equal{\therandomdir}{EVENT}}{{\textbf{\thecardtext}}}{\emph{Возбуждают ли ИМЯ фантазии} {\textbf{\thecardtext}}?} }%
    
    \ifthenelse{\equal{\therandomdir}{L}}
    {\linenode[draw,line width=0.025in,rounded corners=0.1in]{-1.1,-1.22in}{0,-1.47}{\Repeat{\therandomcount}{\textleftarrow}}}{}

    \ifthenelse{\equal{\therandomdir}{R}}
        {\linenode[draw,line width=0.025in,rounded corners=0.1in]{0,-1.22in}{1.1,-1.47}{\Repeat{\therandomcount}{\textrightarrow}}}
    {}

    \ifthenelse{\equal{\therandomdir}{EVENT}}
        {\linenode[draw,line width=0.025in,rounded corners=0.1in]{-1.1,-1.22in}{1.1,-1.47} {Событие}}
    {}

    \linenode[]{-1.1,-1.52in}{1.1,-1.62}{{\small fevronia.leotsarev.ru}}
    
}

\DTLforeach*
{cards}% database label
{\csvtype=type,\csvcardtext=cardtext,\csvdirection=direction,\csvcount=count}% assignment
{% Stuff to do at each iteration:
  \begin{tcard}{fev}%
    \cardtext{\csvcardtext}%
	\type{\csvtype}%
    \randomdir{\csvdirection}
    \randomcount{\csvcount}
\end{tcard}
}

\end{document}