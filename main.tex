\documentclass{article}

\usepackage[TU]{fontenc}
\usepackage[english, russian]{babel}
\usepackage{tcardz}
\usepackage{xifthen}
\usepackage{datatool}
\usepackage[a4paper,margin=0.5in,lmargin=1in,landscape]{geometry}
\setlength\parindent{0pt}
\usepackage{fontspec}
\renewcommand{\familydefault}{\sfdefault}
\usepackage{libertine}

\begin{document}
\exhyphenpenalty 10000
\hyphenpenalty 10000
\DTLsetseparator{,}
\DTLloaddb{cards}{cards.csv}
\newtcard{card}{%
	\newcommand\cardwidth{2.5in}%
	\newcommand\cardheight{3.5in}%
}{%
	\useasboundingbox[clip] (-0.5*\cardwidth,-0.5*\cardheight) rectangle (0.5*\cardwidth,0.5*\cardheight);%
 \drawborder{0.05in}{0.1in}%
}%
\newcommand{\Repeat}[2]{% \repeat already defined
    \foreach \n in {1,...,#1}{#2}
}
\expandtcard{fev}{card}{%
	\newtcardvar{cardtext}{Трогать женскую грудь}%
	\newtcardvar{type}{ЛАЙТ}%
    \newtcardvar{randomdir}{R}
    \newtcardvar{randomcount}{3}
    }
    {%
    
	\linenode[draw,line width=0.025in,rounded corners=0.1in]{-1.15,1.4}{1.15,1.65}{\thetype}

    \pagenode[draw]{-1.1,0.05in}{1.1in,-1.15in}{\raggedright \emph{Возбуждают ли ИМЯ мысли (фантазии)} \textbf{\thecardtext}? }%
    
    \ifthenelse{\equal{\therandomdir}{L}}
    {\linenode[draw,line width=0.025in,rounded corners=0.1in]{-1.1,-1.25in}{0,-1.5}{\Repeat{\therandomcount}{\textleftarrow}}}{}

    \ifthenelse{\equal{\therandomdir}{R}}
        {\linenode[draw,line width=0.025in,rounded corners=0.1in]{0,-1.25in}{1.1,-1.5}{\Repeat{\therandomcount}{\textrightarrow}}}
    {}

    \linenode[]{-1.1,-1.55in}{1.1,-1.65}{{\small fevronia.leotsarev.ru}}
    
}

\expandtcard{spec}{card}{%
	\newtcardvar{cardtext}{ Все пересаживаются}%
    }
    {%
    
	\linenode[draw,line width=0.025in,rounded corners=0.1in]{-1.15,1.4}{1.15,1.65}{ХАРД — СОБЫТИЕ}

    \pagenode[draw]{-1.1,0.05in}{1.1in,-1.15in}{
    \thecardtext }%
    
    \linenode[]{-1.1,-1.55in}{1.1,-1.65}{{\small fevronia.leotsarev.ru}}
    
}

\DTLforeach*
{cards}% database label
{\csvtype=type,\csvcardtext=cardtext,\csvdirection=direction,\csvcount=count}% assignment
{% Stuff to do at each iteration:
  \begin{tcard}{fev}%
    \cardtext{\csvcardtext}%
	\type{\csvtype}%
    \randomdir{\csvdirection}
    \randomcount{\csvcount}
\end{tcard}
}
\Repeat{3}{\begin{tcard}{spec}%
    \cardtext{\textbf{Все пересаживаются}. После этого потяните еще карту?}%
\end{tcard}
}

\end{document}